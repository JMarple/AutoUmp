#include <xs1.h>

.text
.globl _start
.globl _start.nstackwords
#if defined(__XS2A__)
  .align 4
  .issue_mode single
  _start:
    ENTSP_lu6 0
#else
  .align 2
  _start:
#endif
.set _start.nstackwords, XS1_DBG_BUFFER_WORDS + 1 + (memset.nstackwords)

.set _DoSyscall, 0x40620

.set _DoException, 0x405c0

.set record_decompression_time, 0

//Relocate to the end of memory
.set decompressor_bytes, _edp.bss - _start
.set decompressor_words, (decompressor_bytes + 3) / 4
.set decompressor_src, _start
.set decompressor_dest, .ram_base + .ram_size - (_start.nstackwords * 4 + decompressor_words * 4 + (0x40000 - .ram_base))
.set decompressor_offset, decompressor_dest - decompressor_src
.set done_offset, done + decompressor_offset

  ldc r0, record_decompression_time
  bf r0, skipped_time
  getr r0, 1
  in r1, res[r0]
  ldc r2, 0x7ff
  shl r2, r2, 8
    ldc r3, 0xd0
  or  r2, r2, r3
  stw r1, r2[0]
  freer res[r0]

skipped_time:
  ldap r11, decompressor_src
  mov r0, r11
  ldap r11, decompressor_dest
  ldc r1, decompressor_words
relocation_loop:
  sub r1, r1, 1
  ldw r2, r0[r1]
  stw r2, r11[r1]
  bt r1, relocation_loop
.set relocation_jump_dest, decompressor + decompressor_offset
  bl relocation_jump_dest

//The compressed binary
compressedBinary:
    .byte    75, 104,  64, 119, 209, 254, 236,  23
    .byte     4, 240, 139, 104, 194, 254, 236,  31
    .byte   195, 134,  58, 216,   2, 115,  93, 255
    .byte   236,   7, 212,   6,  68, 116, 240,  31
    .byte    53, 208,   0, 240, 138, 111, 240,  23
    .byte   224,  23,   0, 240,  22,  96,  64, 104
    .byte     0, 240, 139, 108,   0, 240, 200, 210
    .byte     0, 240,   7, 108,  54,  23, 140,  54
    .byte     7, 193,  54,   7, 195, 210,   1, 240
    .byte    25,  54,   4, 198, 106, 200, 234, 207
    .byte   234,   0, 104,   1,  84,   0, 240,  64
    .byte   104,  72, 120,   1, 100,  59,  10, 210
    .byte   176, 248, 236, 151, 194, 122,   1, 144
    .byte   240,  79,  65,  54,   8,  60, 210,   2
    .byte   112,   0, 240, 136,  59,   8, 146,  54
    .byte     2,  64, 119,   0, 240, 156, 210,   1
    .byte   208, 238,   7,   7, 220, 255,   7,   1
    .byte   240,  36, 218, 251,  55,   0, 240,  70
    .byte   111, 192, 106, 251,  47, 192, 119, 192
    .byte   119,   0,   0, 255,  23, 130, 127,   0
    .byte   240,  69, 208, 255,  23, 194, 119, 255
    .byte    23, 128, 127, 134,  54,   3,   4, 249
    .byte   236, 247,  45,  54,   2,   6, 250, 236
    .byte   247,   0, 240,  90,  88, 197, 182, 255
    .byte    23,   0, 240,  89,  96,   0, 105, 255
    .byte    23, 255,  23, 100, 138,   3, 240, 126
    .byte   105, 121,  58, 255,  23, 116, 250, 236
    .byte   143,   0, 240, 143,  88, 206, 174,  59
    .byte    65, 218,  88, 207,  54,   4, 235, 143
    .byte   255,  23,   1, 240, 236, 104, 239,  17
    .byte    54,  26, 155,  81, 238,  59,  10,   0
    .byte   240, 192,  97,  59,  14,  77, 123,  54
    .byte     6, 201, 234, 255,  23, 107, 183, 255
    .byte    23,  25, 167,  48, 145,   0, 240,  26
    .byte    90, 160,  54,   6, 139,  35, 255,  23
    .byte    16,  58, 196, 138,   0, 240,  66, 114
    .byte    65,  60,  59,  73,   1, 115,  66,  68
    .byte   255,  23, 196,  59,  33,  66, 175,  54
    .byte    24,  59,   5,  54,  36,  27,  90,   3
    .byte    18,  54,  36,  82, 179, 157,  16,  23
    .byte   163, 183,  61, 145, 204, 181,  54,  26
    .byte    20, 126,  59,   5,  88, 192, 157,   4
    .byte    71, 104, 157,   4,  69,  68, 136,  66
    .byte    67,  54,   3, 248, 236, 143,   2,  59
    .byte   211,  88, 192, 157,   8,  69,  27,  88
    .byte     3,  16,  54,  36,  80,  51, 157,  16
    .byte    19,  35,  59,  51,   6, 250, 236, 239
    .byte    45, 249, 236, 239,   4,  54,   2, 134
    .byte   103,  59,  81, 192, 119, 255,  23, 132
    .byte   127,  64, 144,   2,  85, 129, 135,  59
    .byte   145,  80,  17, 207, 255,  23,  17,  79
    .byte   255,  23, 144, 143,  54,   4,  54,  70
    .byte     0, 240,  78, 212,   0, 240,   7, 119
    .byte     0, 240, 140, 127,   0, 240, 130,  84
    .byte     0, 240, 195,  54,   2,   4,  85,   0
    .byte   240,  69,  54,   2, 134,  54,   2, 199
    .byte    54,   2,   8,  86,   0, 240,  73,  54
    .byte     2, 138,  54,   2, 203,  54,   2,  64
    .byte   105,   4, 240,  63, 105,   0, 240, 192
    .byte   106,  21, 145, 161, 138,  21, 153, 177
    .byte   138,  21, 145, 197,  54,   2, 213, 138
    .byte    66,  28,  87,  28, 104, 151, 109, 151
    .byte    12, 197,  29, 197, 174, 194, 191, 194
    .byte    34,  68,  55,  68, 104, 145,  61, 161
    .byte   107,  68, 255,  23, 157, 132,   7,  42
    .byte   161,  63, 161, 106,  59,   7, 157, 148
    .byte     9, 104, 163, 125, 163, 157, 164,   9
    .byte   106, 163, 127, 157,  24,   9,  43, 253
    .byte   236, 143,  61, 146, 255,  23, 100, 195
    .byte   157,   4, 117, 179, 117, 157,   4,  93
    .byte     0, 240,  39, 105, 177, 250, 230,  39
    .byte   181, 250, 230,  59,  25, 255,  23,  54
    .byte   246,  54, 214, 100, 195,   0, 240, 141
    .byte    59,  15, 130,  92,   0, 240, 195,  54
    .byte     2,   4,  93,   0, 240,  69,  54,   2
    .byte   134,  54,   2, 199,  54,   2,   8,  94
    .byte     0, 240,  73,  54,   2, 138,  54,   2
    .byte   203,  54,   2, 204, 119, 255,  23, 138
    .byte   127,   0, 240,   2,  85,   0, 240,  67
    .byte    54,   2, 132,  54,   2, 197,  54,   2
    .byte     6,  86,   0, 240,  71,  54,   2, 136
    .byte    54,   2, 201,  54,   2,  11,  59,  15
    .byte    76,  93,   5, 240, 128, 106,  49, 248
    .byte   236,   7,  21, 144,  41, 144, 150, 252
    .byte   236, 207,   7, 106,  65, 106, 127, 168
    .byte    12,  61, 132,  38, 147, 139, 160, 143
    .byte   255,  23, 148,  62, 255,  23, 147, 251
    .byte   157,   5,  85,   2,  59,   9,  67,  54
    .byte     2, 132,  54,   2, 197,  54,   2,   6
    .byte    59,  39,  71,  54,   2, 136,  54,   2
    .byte   201,  54,   2, 202, 119, 157,   9, 153
    .byte   115,  54,   1, 240,  15,  88,   8, 232
    .byte     0, 240,  70, 104, 212, 254, 236,  15
    .byte     0, 115, 157,   5, 149,  54, 158,   0
    .byte   232,  54, 218,  16, 157,  96,   9,  16
    .byte   157,  64,   9,  17, 157,  96,   9,  17
    .byte   157,  64,   9,  18, 157,  96,   9,  18
    .byte   157,  64,   9,  19, 157,  96,   9,  19
    .byte   157,  64,   9,  20, 157,  96,   9,  20
    .byte   157,  16,   9,  66, 119, 194, 134,   2
    .byte   116, 124, 240,   2, 104,   0, 240, 207
    .byte   110,  92,  23, 209,  78, 209, 206,  59
    .byte     4,  88,  65, 232, 201, 182, 237,   7
    .byte   202, 106, 171,  20,  73, 232, 217,  22
    .byte     9, 216, 241,  71,   6, 216, 240,  71
    .byte    65, 123, 240,   7, 255,  23, 241,   7
    .byte   236,   7, 209, 206,   2, 104,  65,  59
    .byte    11,  64, 127,  21, 152, 173,  73, 216
    .byte    22, 208,  14, 209,  78,  70, 116,   5
    .byte    54,   9,  89, 208,   0, 240,  65, 127
    .byte     0, 104,  96, 104,   2, 105, 172,   9
    .byte   184, 172,  56,  71,  88,  48,  71, 121
    .byte   168, 164, 104,  66, 188, 164, 124,  66
    .byte   222,  22, 124, 148,   3, 115, 160,  54
    .byte     7, 226,  23,   1, 144,  33,  48, 146
    .byte   124,  59, 110, 105, 214,   0, 104, 194
    .byte   157,  16,  65,  36, 144,  16, 144,  13
    .byte    54,  10,  75, 216, 251,  39,   0, 240
    .byte    66, 119,   0, 104,  16, 144,   0, 240
    .byte    76,  59,  28,  80,  54,   2, 126, 211
    .byte     0, 240,  82,  54,   4,  68, 119,   2
    .byte    85,  64, 144, 157,   6, 169,  63,  54
    .byte     7,  67,  54,   2, 113, 211, 192, 157
    .byte    16,   5,  64, 119, 237,   7, 236,   7
    .byte     0, 240, 195, 110, 255,  23,  59,  83
    .byte    64, 119, 201, 134,  54,   3,  96, 238
    .byte    23, 167, 252, 236,   7, 157,  24, 117
    .byte   240, 128,  54,   9, 171,  76, 226,  23
    .byte    54,   9,  54,   8, 225, 143, 238,  23
    .byte    54,  26, 171,  76,  48, 248, 236, 151
    .byte   198, 120,   0, 240, 208, 108,  55,  16
    .byte   222,  22, 137, 232, 206, 182,   4,  16
    .byte   210,  54,   4, 194, 182, 157,  20,  15
    .byte   208, 166,  59, 203,  54,  56,  66,  54
    .byte     6,   8, 212, 157,  12,  81,  54,  22
    .byte   198, 208, 157,  20,  87,   7, 104,   0
    .byte   240,  25, 212,  59, 184,  54,  40,  16
    .byte   144,   0,  54,   9,  34,  54,  57,  54
    .byte     8, 129, 135,   0, 240,  28,  80,  59
    .byte   215,   0, 240,  92,  88, 197, 182,  16
    .byte     8,  37, 144,  32,  59,   7, 156,  88
    .byte   202, 174,  33,   8,  41,  48, 131, 124
    .byte   157,  20,  43,  17,   8,  21, 144,  17
    .byte     0,  59, 199, 212, 166,  16,   0,  64
    .byte   104,  54,  39,  54,  46, 238,  23,  16
    .byte     8, 151,  52,  83, 112,  59, 211,  32
    .byte     8, 212, 166,   7, 115,  59, 211,  54
    .byte    35,  54,   9,  41,  48, 137, 124, 176
    .byte    59,   7,  59,   1, 174, 157,  24,  22
    .byte   157,  20,  29, 152,  17,   0,  72, 157
    .byte    16,  15,  59,  94,  59,  59,  88, 192
    .byte   174, 157,  28,  95,  11,  96,   0, 240
    .byte    52, 157,  16,  97, 157,   4, 173,   0
    .byte   240,  13,  54,   9,  61, 212,   0, 240
    .byte    29,  88,  30, 112, 128, 104,   0, 240
    .byte   150,  80, 210, 166,   0, 240,  23,  80
    .byte     0, 240,  30,  54,  13,  24,  54,   4
    .byte     8,  88,  68,  54,  12,  29, 208,   0
    .byte   240,   9,  88,  73, 104,  17, 167, 224
    .byte   144,   0, 240,  22,  54,   7,  10,  88
    .byte    82, 104, 130,  54,  13,  16,  54,   6
    .byte    29,  81,  59, 214,  68, 212,   2,  93
    .byte   196,  59,  37, 157,  20,  39,  76, 157
    .byte    24, 151, 192, 104,  48,   0,  49,   0
    .byte    50,   0, 179, 248, 236, 159, 159, 249
    .byte   236, 135,  78, 104,  17,  16,  39, 248
    .byte   236, 135, 112,   2, 113,   2, 114,   2
    .byte    67,   2,   0, 240, 162, 217,  48,   5
    .byte     0, 240, 193, 217,  49,  54,   3, 236
    .byte   217,  50,  54,   3,  15, 218,  51,   5
    .byte     1, 240,  84, 104,   1,  16,   0, 240
    .byte   151,  59,  86,  59, 157, 130, 217, 140
    .byte   145,   0, 240,  81, 157,   4, 190, 240
    .byte    64, 119, 132, 119, 157,   7, 136, 130
    .byte    85,  46, 120,  64, 154,   1, 240,  99
    .byte    88, 192, 104,  80, 120, 176,   8, 204
    .byte    17,   1, 240, 163,  96,  84,   8,  37
    .byte    17,  40,  49, 139, 113, 164,  50, 151
    .byte   113,  81, 200,  90, 113, 100, 146,  24
    .byte     8,  75, 116,  23, 115,  54,  30,  20
    .byte   115, 237,  19,  36,   0,  53,   8, 210
    .byte    59,   8, 140,  17,   3,  48,  14, 120
    .byte    12,   8,   2,  16,   4,   0,  13,   8
    .byte     5,   0,   8, 115, 253,  19,  48,   0
    .byte    21,   8,  17,   0,   2, 115,  52, 144
    .byte    49,   0,   8,   0, 130,  93, 157,   7
    .byte    61, 132, 103, 157,   4, 203, 157,  13
    .byte    73,   0, 240, 202, 209, 157,   5,  68
    .byte    67, 212,   0, 240, 205, 209, 157,   8
    .byte   108, 157,  16, 209,   1, 240,  36,  96
    .byte   131, 252, 236,  31,  59,  71,  76, 119
    .byte     6, 249, 236, 247,  47,  54,   2,  68
    .byte   252, 236, 247, 138,  86,   3,  84,   0
    .byte   240, 198, 212, 192, 105,   0, 240,  86
    .byte    96,   1, 240, 156, 106,   8, 240,  64
    .byte   106,  28, 145,  69,   8, 209, 166, 192
    .byte   192,  41, 112,  66,  84, 102,   8,   1
    .byte   153,  75, 249, 236, 159, 195, 131,  49
    .byte    71,  29, 120, 145,  60,  72, 112,   1
    .byte   240,  20, 104, 200,  16,   0, 240,  15
    .byte   213,  54,  26,  14, 120,  78, 104, 217
    .byte    16,  87, 130,  53,  71,  57, 167,  22
    .byte    48,  69, 112, 200, 144,  67,  92, 225
    .byte    39, 145,  66, 195, 131, 129,  60,   5
    .byte   157,  24,   7,   7, 213, 170,  21,  12
    .byte   195,  38, 116,   1, 115,  66,  84,  66
    .byte    92,  20,   8, 113, 116,   0, 240, 203
    .byte   212, 196, 144, 138,  94,  59,  52, 239
    .byte    59,  56, 239,  59,  60, 239, 204, 119
    .byte     0, 240,  74, 119,   5,  59,  63,  46
    .byte    54,   2,   7, 250, 236, 247, 136,  86
    .byte   157,   4,  93,  29,  88,   2, 112,   0
    .byte   240,  17, 213,  83,  59,  53, 192, 105
    .byte   199, 131,   8, 240,   0, 106, 144,  60
    .byte    66, 120,  49,  71,   7, 115,  59,  98
    .byte   192,  59,  34,  86, 213,   0, 104, 132
    .byte   129,  16, 144,  53,  55, 136, 104,  38
    .byte    56, 156, 120,  80,  11, 118, 121, 224
    .byte     8, 169,  26,  16,   1, 214,  70,  65
    .byte   112, 113,  11,  50,   1, 213, 166, 217
    .byte   192,  78, 112, 192, 105, 241,  13,  19
    .byte    11, 204, 144, 228, 144, 248, 144, 235
    .byte    39, 220, 192, 105, 120,  20,  17,  40
    .byte    25,  14, 195,  12, 116, 199, 131, 128
    .byte    60,  29, 115,  32, 240,   0, 104,  20
    .byte    64, 128, 106,  22, 254, 236, 135, 193
    .byte     8, 136, 193,   7, 112,  60,  59,  97
    .byte     8, 217, 166,   2, 192,   1, 240,  27
    .byte   112, 146,  13,   1, 240,  88, 121,  64
    .byte   240, 192, 105,  71,  58,  20, 120,   1
    .byte   240,  16,  54,  15,  96,   8,  29, 115
    .byte   132,  60,  64, 105,   1, 240,  52, 112
    .byte     1, 240,  45, 115, 199, 131,   1, 240
    .byte    64, 104,  17,  64, 215, 251, 236, 135
    .byte   128,  60,   1, 240,  15, 115,  19,  11
    .byte   192, 105, 221, 166, 204, 144, 236, 144
    .byte   229,  39,  96, 144,  20, 167,   9,  51
    .byte     1, 240,   7, 112, 215, 131,  59,  85
    .byte     4, 104,   4,  56,  10, 120, 193,   8
    .byte    40,  25,  48,  59, 166,   4, 120,  59
    .byte   234,  40,  25, 242,  13,  19,  11,  64
    .byte   105, 196, 144, 232, 144, 244, 144, 235
    .byte    39, 229, 131,  66,  50,  36, 120, 223
    .byte   243,  63, 104,  24,  56, 213,  59,  30
    .byte    17,   1,   0,  11, 192,   0,  75,  58
    .byte     4, 157,  20,  52,   0,  48, 104,  32
    .byte    17, 200,   8,   9,  54,   8, 128, 104
    .byte   226,  16,  34,  48, 131, 112,   0, 240
    .byte    16, 213, 213, 131,  24,   1, 132, 157
    .byte    16, 183, 157,   4, 134, 205, 213, 216
    .byte   145,  32, 115,   1, 240,   0, 104,   8
    .byte    64, 197,  59,  21, 136,  60,  20, 167
    .byte    24, 112,  18, 115,   0, 240,  24, 213
    .byte     0,   8,  93, 104,  17,  48, 199, 131
    .byte    66, 120,  28, 145, 157,   4, 159,  64
    .byte   104,   1,  64,  49,  71,  64, 104, 133
    .byte   249, 157,   4,  86, 157,  28,  19, 239
    .byte   213, 196, 144, 136,  94,   7, 250, 236
    .byte   239,  46, 249, 236, 239,   5,  54,   2
    .byte   157,   7, 119,  66, 119,   3, 120,   0
    .byte   240, 227, 212,   4, 115,   7, 220, 157
    .byte     5, 122,  56, 213, 157,  21, 221, 157
    .byte     4, 219,  68, 144,  14,  59,  15,  64
    .byte   105,  65, 130,  24, 144,  44, 144,   0
    .byte   240, 131, 208,  16, 248, 236, 151,  71
    .byte    59,  27,  80, 104, 209,  16,  36,   8
    .byte    40,  16,  36,   0,   8, 115, 211, 248
    .byte   236, 159, 101, 130, 191, 243, 255, 104
    .byte    43,  56, 101, 250, 236, 135,  59,  95
    .byte   157,   5, 209,  72, 157,  24, 253,   6
    .byte    86,  76, 144,  88, 144, 100, 144, 157
    .byte     5,  60, 192, 105, 195, 131,   4, 157
    .byte     4, 167,  56,  73, 120,  14, 104, 200
    .byte    16,  67, 130, 130, 104, 220,  59,  31
    .byte   105, 208, 195, 131,   1, 115,  49,  71
    .byte   191, 243, 127, 104,   1,  56, 195, 251
    .byte   236, 135,  54,  63, 212, 144, 157,   6
    .byte     7,  80, 208,   6,  94, 157,  20,  77
    .byte   200, 157,   9, 145, 157,  68,  65,  71
    .byte   208,  59, 247, 220, 166,  51,  48, 202
    .byte   112,  64, 240, 192, 104,  43,  64,  59
    .byte   122, 157,  12,  73,   4,   0,   5, 115
    .byte   157,  56,  68, 157,  10,  29,  14, 104
    .byte     4,  16,  64, 104,   1, 128,   0, 240
    .byte    48, 157,  18, 199,  66, 119,   1, 240
    .byte    44,  96,   0, 240, 198, 214,  54, 184
    .byte   190,  54,  72,  64, 119,  56, 144, 157
    .byte     7,  62, 157,   7,  98,  30, 157,   7
    .byte    62,  54, 138,   6,  54,  10,  20,  54
    .byte   202,   8,  54,  10,  10,  54, 106,  16
    .byte   144,   4,  54,   8,   2,  54,  72, 157
    .byte     6,  57,  36, 215, 196, 142,  87, 170
    .byte    65, 120, 194, 119, 196, 150,  65,  84
    .byte     0, 240,   4, 214,  65,  92,  16,   0
    .byte   208, 166, 157,  22,  73,  16, 215,   0
    .byte   240,  14, 109,   6, 121,   0, 240,  72
    .byte   109,   1, 153,   4,  75, 224,  39,   4
    .byte   117,  54,  62, 132, 119,   1,  85,  66
    .byte    85, 131,  85,   0, 240, 141, 109, 136
    .byte   121,   0, 105,   0, 240,  73, 109,  59
    .byte    65,   1, 145, 178, 203, 197, 118,   0
    .byte   240, 111, 215,   1,  93,  66,  93, 131
    .byte    93, 132, 103, 194, 119,  12,   0,  59
    .byte    41,  54,   1,   1,   0,   1,   1,  15
    .byte    12,  14,   0,   2,  30,   1,  54,  39
    .byte   255,  54,   3, 112,  23, 240, 255,  48
    .byte    24, 240, 255,  54,  24,  80,  13,   4
    .byte     0,   8,  15,   4,   0,  56,  54,   4
    .byte    32,  54,   2, 120, 255,   7,   0,  96
    .byte     1,  59, 207,   6,  54,  66,  59,  79
    .byte   255, 255, 255, 127, 236,   3,   4,   0
    .byte    28,   4,   4,   0,  76,  54,   2, 124
    .byte    54,   2, 172,  54,   2, 220,  54,   2
    .byte   208,  54,  12,   0,  54,   4,  48,  54
    .byte     2,  96,  54,   2, 144,  54,   2, 192
    .byte    54,   2,  59, 106,  54, 241,  54, 113
    .byte   200,  59,  41,  36,  14,   4,   0, 128
    .byte    54,   2,  59,  33,  59,  57,   0,  54
    .byte   100,   0,   5,  59, 219,   0,  12,  59
    .byte    20,  13,  54,   2,   8,  54,   2,  11
    .byte     1,   0
    .align 2
compressedBinaryEnd:

//Code for decompressing the compressed binary
decompressor:
    ldc r0, 54
    ldc r1, 59
    ldc r2, 157
    ldap r11, compressedBinaryEnd
    or r3, r11, r11
    ldc r4, 0x400
    shl r4, r4, 8
    or r5, r4, r4
    ldap r11, compressedBinary
    ldc  r6, 0
loop:
    lsu  r10, r11, r3
    bf   r10, done
    ld8u r7, r11[r6]
    add  r11, r11, 1
    eq   r10, r7, r0
    bt   r10, marker
    eq   r10, r7, r1
    bt   r10, marker
    eq   r10, r7, r2
    bt   r10, marker
copyChar:
    st8  r7, r4[r6]
    add  r4, r4, 1
    bu   loop
marker:
    ld8u r8, r11[r6]
    add  r11, r11, 1
    bf   r8, copyChar
    eq   r10, r7, r0
    bt   r10, marker0
    eq   r10, r7, r1
    bt   r10, marker1
marker2:
    shr  r7, r8, 2
    zext r8, 2
    ld8u r10, r11[r6]
    add  r11, r11, 1
    shl  r8, r8, 8
    or   r8, r8, r10
    bu   adjustR8
marker1:
    shr  r7, r8, 6
    zext r8, 6
adjustR8:
    add  r8, r8, 11
    add  r8, r8, 4
    bu   copyManyChars
marker0:
    shr  r7, r8, 4
    zext r8, 4
copyManyChars:
    shl  r8, r8, 1
    add  r7, r7, 3
    sub  r9, r6, r8
loopChar:
    ld8u r10, r4[r9]
    st8  r10, r4[r6]
    add  r4, r4, 1
    sub  r7, r7, 1
    bt   r7, loopChar
    bu   loop
done:
    ldc r0, record_decompression_time
    bf r0, real_done
    getr r0, 1
    in r1, res[r0]
  ldc r2, 0x7ff
  shl r2, r2, 8
    ldc r3, 0xd0
  or  r2, r2, r3
    ldw r4, r2[0]
    sub r1, r1, r4
    stw r1, r2[0]
    freer res[r0]
real_done:
    bau  r5

