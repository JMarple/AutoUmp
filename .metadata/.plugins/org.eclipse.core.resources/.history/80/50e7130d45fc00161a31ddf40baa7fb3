extern "C"
{
    #include "rs232.h"
}
#include <cstdint>
#include <iostream>

int main()
{
    char mode[] = "8N1";
    const int COM_PORT = 0;
    if (RS232_OpenComport(COM_PORT, 921600, mode))
    {
        std::cout << "Could not find com port" << std::endl;
        return 0;
    }

    const uint32_t size = 320*240;
    uint8_t currentImage[size];
    uint32_t index = 0;

    while (
    {
        int len = RS232_PollComport(COM_PORT, &currentImage[index], size - index);
        index += len;

        for (int i = 0; i < len; i++)
        {
            printf("%x ", currentBuf[i]);
        }
    }

    RS232_CloseComport(COM_PORT);
    std::cout << "Done!" << std::endl;

    return 0;
}
