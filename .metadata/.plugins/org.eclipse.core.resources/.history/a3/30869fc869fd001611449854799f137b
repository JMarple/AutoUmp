	//.globl ov7670_capturerow.nstackwords
	//.linkset ov7670_capturerow.nstackwords, 10
	.globl computeOV7670Data
	.align 4
	.issue_mode dual

// r0 is tmpBuffer
// r1 is saved old data
computeOV7670Data:
	dualentsp 10

	stw r4, sp[2]
	stw r5, sp[3]
	stw r6, sp[4]
	stw r7, sp[5]

	#define tmpBufPtr r0
	#define oldBufPtr r1
	#define loopCutoff r4
	#define x r5
	#define lNewData r6
	#define rNewData r7
	#define lOldData r8
	#define rOldData r9

	ldc x, 0
	ldc loopCutoff, 79

	// Copy tmpBuffer to oldBuffer
	/*computeloop:
		{ldw lNewData, tmpBufPtr[x]; nop}
		stw lNewData, oldBufPtr[x]
		{add x, x, 1; lss lNewData, x, loopCutoff}
		bt lNewData, computeloop*/

	computeloop:
		{ld8u lNewData, tmpBufPtr[x]; nop}


	ldw r4, sp[2]
	ldw r5, sp[3]
	ldw r6, sp[4]
	ldw r7, sp[5]
	retsp 10


